<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  


  <head>
    <title>
      help/howtos/security/split_wlan_lan – Freetz
    </title>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!--[if IE]><script type="text/javascript">
      if (/^#__msie303:/.test(window.location.hash))
        window.location.replace(window.location.hash.replace(/^#__msie303:/, '#'));
    </script><![endif]-->
        <link rel="search" href="/search" />
        <link rel="help" href="../../../TracGuide.html" />
        <link rel="alternate" href="split_wlan_lan%3Fformat=txt" type="text/x-trac-wiki" title="Reiner Text" />
        <link rel="up" href="../security.html" title="Übergeordnete Wiki-Seite anzeigen" />
        <link rel="start" href="/wiki" />
        <link rel="stylesheet" href="../../../../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../../../../chrome/common/css/wiki.css" type="text/css" /><link rel="stylesheet" href="../../../../chrome/wikiextras/css/phrases.css" type="text/css" /><link rel="stylesheet" href="../../../../chrome/wikiextras/css/boxes.css" type="text/css" /><link rel="stylesheet" href="../../../../chrome/wikiextras/css/boxes-300.css" type="text/css" /><link rel="stylesheet" href="../../../../chrome/wikiextras/css/boxes-narrow-toc.css" type="text/css" /><link rel="stylesheet" href="../../../../wikicss.css" type="text/css" /><link rel="stylesheet" href="../../../../chrome/tags/css/tractags.css" type="text/css" /><link rel="stylesheet" href="../../../../chrome/wikinegotiator/css/langmenu-ctxnav.css" type="text/css" />
        <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
        <link rel="icon" href="/favicon.ico" type="image/x-icon" />
      <link type="application/opensearchdescription+xml" rel="search" href="/search/opensearch" title="Freetz durchsuchen" />
      <script type="text/javascript" charset="utf-8" src="../../../../chrome/common/js/jquery.js"></script>
      <script type="text/javascript" charset="utf-8" src="../../../../chrome/common/js/babel.js"></script>
      <script type="text/javascript" charset="utf-8" src="../../../../chrome/common/js/messages/de.js"></script>
      <script type="text/javascript" charset="utf-8" src="../../../../chrome/common/js/trac.js"></script>
      <script type="text/javascript" charset="utf-8" src="../../../../chrome/common/js/search.js"></script>
      <script type="text/javascript" charset="utf-8" src="../../../../chrome/common/js/folding.js"></script>
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("#content").find("h1,h2,h3,h4,h5,h6").addAnchor(_("Link to this section"));
        $("#content").find(".wikianchor").each(function() {
          $(this).addAnchor(babel.format(_("Link to #%(id)s"), {id: $(this).attr('id')}));
        });
        $(".foldable").enableFolding(true, true);
      });
    </script>
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="/wiki"><img src="../../../../chrome/common/freetz_motd.png" alt="Freetz" /></a>
      </div>
      <form id="search" action="/search" method="get">
        <div>
          <label for="proj-search">Suche:</label>
          <input type="text" id="proj-search" name="q" size="18" value="" />
          <input type="submit" value="Suche" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="/login">Anmelden</a></li><li><a href="/prefs">Einstellungen</a></li><li><a href="../../../TracGuide.html">Hilfe/Anleitung</a></li><li><a href="/about">Über Trac</a></li><li><a href="/notification" title="Wiki Pages Change Notifications">My Notifications</a></li><li><a href="/register">Registrieren</a></li><li class="last"><a href="../../../Impressum.html">Impressum</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first active"><a href="/wiki">Wiki</a></li><li><a href="/timeline">Journal</a></li><li><a href="/roadmap">Projektplan</a></li><li><a href="/browser">Quellen durchsehen</a></li><li><a href="/report">Tickets anzeigen</a></li><li><a href="/search">Suche</a></li><li><a href="/tags">Tags</a></li><li><a href="/downloads">Downloads</a></li><li class="last"><a href="/screenshots">Bildschirmfotos</a></li>
    </ul>
  </div>
    <div id="langmenu"><ul><li class="first"><span title="Select a language of wiki content">Language:</span></li><li class=" active"><a class="" href="split_wlan_lan..html" title="displaying language (default)">German</a></li><li class=" last"><a class=" notexist" href="/wiki/help/howtos/security/split_wlan_lan.en" title="(not available)">English</a></li></ul></div><div id="main">
      <div id="pagepath" class="noprint">
  <a class="pathentry first" title="Zeige WikiStart an" href="/wiki">Wiki:</a><a class="pathentry" href="../../../help.html" title="Zeige help an">help</a><span class="pathentry sep">/</span><a class="pathentry" href="../../howtos.html" title="Zeige help/howtos an">howtos</a><span class="pathentry sep">/</span><a class="pathentry" href="../security.html" title="Zeige help/howtos/security an">security</a><span class="pathentry sep">/</span><a class="pathentry" href="split_wlan_lan.html" title="Zeige help/howtos/security/split_wlan_lan an">split_wlan_lan</a>
</div>
      <div id="ctxtnav" class="nav">
        <h2>Kontext-Navigation</h2>
        <ul>
          <li class="first"><a href="../security.html">Aufwärts</a></li><li><a href="../../../WikiStart.html">Startseite</a></li><li><a href="../../../TitleIndex.html">Inhaltsverzeichnis</a></li><li><a href="split_wlan_lan%3Faction=history.html">Änderungshistorie</a></li><li class="last"><a href="/notification/help/howtos/security/split_wlan_lan." title="Watch Page">Watch Page</a></li>
        </ul>
        <hr />
      </div>
    <div id="content" class="wiki">
      <div class="wikipage searchable">
        
          <div id="wikipage" class="trac-content"><p>
</p><div class="wiki-toc"><h4>Inhaltsverzeichnis</h4><ol><li><a href="switch_config.html#KonfigurationdeseingebautenSwitches">Konfiguration des eingebauten Switches</a><ol><li><a href="switch_config.html#Vorwort">Vorwort</a></li><li><a href="switch_config.html#VordefinierteSwitch-Konfigurationen">Vordefinierte Switch-Konfigurationen</a></li><li><a href="switch_config.html#Anpassungeninderar7.cfg">Anpassungen in der ar7.cfg</a></li><li><a href="switch_config.html#Beispiel">Beispiel</a></li><li><a href="switch_config.html#Sicherheits-Warnung">Sicherheits-Warnung</a></li><li><a href="switch_config.html#Kompatibilität">Kompatibilität</a></li></ol></li><li><a href="user_management.html#Benutzerverwaltung">Benutzerverwaltung</a><ol><li><a href="user_management.html#Benutzeranlegen">Benutzer anlegen</a></li><li><a href="user_management.html#Benutzerlöschen">Benutzer löschen</a></li><li><a href="user_management.html#ManuelleAnpassungen">Manuelle Anpassungen</a></li><li><a href="user_management.html#Besonderheiten">Besonderheiten</a></li></ol></li><li class="active"><a href="split_wlan_lan.html#WLANvonLANtrennenmitiptables">WLAN von LAN trennen mit iptables</a><ol><li class="active"><a href="split_wlan_lan.html#FRITZBoxEinstellung">FRITZBox Einstellung</a></li><li class="active"><a href="split_wlan_lan.html#iptables">iptables</a></li></ol></li><li><a href="router_and_firewall.html#FreetzalsinternerRoutermitFirewall">Freetz als interner Router mit Firewall</a><ol><li><a href="router_and_firewall.html#Zielgruppe">Zielgruppe</a></li><li><a href="router_and_firewall.html#Beispielszenario">Beispielszenario</a></li><li><a href="router_and_firewall.html#DieFritzboxmodden">Die Fritzbox modden</a></li><li><a href="router_and_firewall.html#DieFritzboxaufgetrennteNetzeumstellen">Die Fritzbox auf getrennte Netze umstellen</a></li><li><a href="router_and_firewall.html#ErstellenderRouten">Erstellen der Routen</a></li><li><a href="router_and_firewall.html#DieRückrouten">Die Rückrouten</a></li><li><a href="router_and_firewall.html#Firewall">Firewall</a></li><li><a href="router_and_firewall.html#FIXMEkopierterPost">FIXME kopierter Post</a></li></ol></li></ol></div><p>
</p>
<h1 id="WLANvonLANtrennenmitiptables">WLAN von LAN trennen mit iptables</h1>
<p>
Diese Anleitung erklärt, wie man den Zugriff vom WLAN der FRZITZBox beschränken kann, um z. B. das WLAN für jeden zugänglich zu machen, ohne das interne LAN oder die FRITZBox selbst zu gefährden.
</p>
<h2 id="FRITZBoxEinstellung">FRITZBox Einstellung</h2>
<p>
Zuerst muss im FRITZBox-Webinterface unter <em>System &rarr; Netzwerkeinstellungen &rarr; IP-Adressen</em> die Option <em>"Alle Computer befinden sich im selben IP-Netzwerk"</em> deaktiviert sein (siehe auch <a href="/screenshots/48" title="Einstellungen für separate Netzwerke (Fritz!Box 7050)">Screenshot</a>). Dabei werden nicht nur die Netze getrennt, es entsteht auch ein neues Interface <em>wlan</em>.
</p>
<h2 id="iptables">iptables</h2>
<p>
Jetzt können die Regeln für iptables gesetzt werden. Dies sind einfache Befehle, die auf der Kommandozeile per <em>telnet</em> oder <em>ssh</em> ausgeführt werden. Sollen sie dauerhaft bestehen bleiben, kann man sie z.B. einfach in die <tt>/var/flash/debug.cfg</tt> schreiben.
</p>
<h3 id="Netzwerksichern">Netzwerk sichern</h3>
<div class="code"><pre>iptables -A FORWARD -i wlan -o dsl -j ACCEPT
iptables -A FORWARD -i wlan -j DROP
</pre></div><p>
Damit wird das interne Netz geschützt, die Box selbst jedoch nicht.
</p>
<div class="code"><pre>iptables -A INPUT -i wlan -p tcp -j DROP
iptables -A INPUT -i wlan -p udp -j DROP
</pre></div><p>
Jetzt ist auch der Zugriff per TCP/UDP auf die Box blockiert, sie antwortet dennoch auf Pings.
</p>
<h3 id="Zugriffeerlauben">Zugriffe erlauben</h3>
<p>
Allerdings ist jetzt auch der DNS-Server nicht mehr erreichbar und die Computer im WLAN können keine Domainnamen (z. B. <em>www.wikipedia.org</em> anstatt 145.97.39.155) mehr aufrufen.
</p>
<p>
Die Regeln werden von iptables der Reihe nach abgearbeitet. Die Option <strong>-A</strong> in den vorigen Befehlen steht für <em>append</em>, d. h. die Regeln wurden am <em>Ende der Liste</em> eingefügt.
</p>
<p>
Mit <strong>-I</strong> (für <em>insert</em>) kann man nun Regeln an den <em>Beginn der Liste</em> setzen, um Ausnahmen für bestimmte Dienste einzurichten, z. B. für den DNS-Server via TCP und UDP.
</p>
<div class="code"><pre>iptables -I INPUT -i wlan -p tcp --dport 53 -j ACCEPT
iptables -I INPUT -i wlan -p udp --dport 53 -j ACCEPT
</pre></div><p>
Danach können Computer im WLAN wie gewohnt die Internetverbindung benutzen ohne Zugriff auf das Webinterface der Box oder Computer im LAN zu haben.
</p>
<p>
Der Zugriff auf die Box lässt sich beliebig nach dem Schema
</p>
<div class="code"><pre>iptables -I INPUT -i wlan -p &lt;Protokoll&gt; --dport &lt;Port&gt; -j ACCEPT
</pre></div><p>
erweitern.
</p>
<h3 id="Beispiele">Beispiele</h3>
<div class="code"><pre><span class="c"># ssh
</span>iptables -I INPUT -i wlan -p tcp --dport 22 -j ACCEPT
<span class="c"># OpenVPN
</span>iptables -I INPUT -i wlan -p udp --dport 1194 -j ACCEPT
</pre></div></div>
          
          <div class="trac-modifiedby">
            <span><a href="split_wlan_lan%3Faction=diff&amp;version=1.html" title="Version 1 von Izzy">zuletzt geändert</a> <a class="timeline" href="/timeline?from=2008-09-22T14%3A44%3A19Z&amp;precision=second" title="Siehe Journal am 22.09.2008 14:44:19">vor 10 Jahren</a></span>
            <span class="trac-print">Zuletzt geändert am 22.09.2008 14:44:19</span>
          </div>
        
        
      </div>
      

    </div>
    <script type="text/javascript">
        jQuery.loadStyleSheet("/pygments/trac.css", "text/css");
    </script>
    <div id="altlinks">
      <h3>In anderen Formaten herunterladen:</h3>
      <ul>
        <li class="last first">
          <a rel="nofollow" href="split_wlan_lan%3Fformat=txt">Reiner Text</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="../../../../chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">Betrieben mit <a href="/about"><strong>Trac 1.0.1</strong></a><br />
        von <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right"><div class="field" align="right"><form action="https://www.paypal.com/cgi-bin/webscr" method="post"><input type="hidden" name="cmd" value="_donations"/><input type="hidden" name="business" value="spenden@freetz.org"/><input type="hidden" name="item_name" value="Freetz Entwickler-Team"/><input type="hidden" name="no_shipping" value="1"/><input type="hidden" name="return" value="http://freetz.org"/><input type="hidden" name="cn" value="Name oder IPPF-Pseudonym"/><input type="hidden" name="currency_code" value="EUR"/><input type="hidden" name="tax" value="0"/><input type="hidden" name="lc" value="DE"/><input type="hidden" name="bn" value="PP-DonationsBF"/><input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_LG.gif" border="0" name="submit" alt="Zahlen Sie mit PayPal - schnell, kostenlos und sicher!"/><img alt="" border="0" src="/pixel.gif" width="1" height="1"/></form></div></p>
    </div>
  </body>
</html>