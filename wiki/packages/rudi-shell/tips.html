<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  


  <head>
    <title>
      packages/rudi-shell/tips – Freetz
    </title>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!--[if IE]><script type="text/javascript">
      if (/^#__msie303:/.test(window.location.hash))
        window.location.replace(window.location.hash.replace(/^#__msie303:/, '#'));
    </script><![endif]-->
        <link rel="search" href="/search" />
        <link rel="help" href="../../TracGuide.html" />
        <link rel="alternate" href="tips%3Fformat=txt" type="text/x-trac-wiki" title="Reiner Text" />
        <link rel="up" href="../rudi-shell.html" title="Übergeordnete Wiki-Seite anzeigen" />
        <link rel="start" href="/wiki" />
        <link rel="stylesheet" href="../../../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../../../chrome/common/css/wiki.css" type="text/css" /><link rel="stylesheet" href="../../../chrome/wikiextras/css/phrases.css" type="text/css" /><link rel="stylesheet" href="../../../chrome/wikiextras/css/boxes.css" type="text/css" /><link rel="stylesheet" href="../../../chrome/wikiextras/css/boxes-300.css" type="text/css" /><link rel="stylesheet" href="../../../chrome/wikiextras/css/boxes-narrow-toc.css" type="text/css" /><link rel="stylesheet" href="../../../wikicss.css" type="text/css" /><link rel="stylesheet" href="../../../chrome/tags/css/tractags.css" type="text/css" /><link rel="stylesheet" href="../../../chrome/wikinegotiator/css/langmenu-ctxnav.css" type="text/css" />
        <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
        <link rel="icon" href="/favicon.ico" type="image/x-icon" />
      <link type="application/opensearchdescription+xml" rel="search" href="/search/opensearch" title="Freetz durchsuchen" />
      <script type="text/javascript" charset="utf-8" src="../../../chrome/common/js/jquery.js"></script>
      <script type="text/javascript" charset="utf-8" src="../../../chrome/common/js/babel.js"></script>
      <script type="text/javascript" charset="utf-8" src="../../../chrome/common/js/messages/de.js"></script>
      <script type="text/javascript" charset="utf-8" src="../../../chrome/common/js/trac.js"></script>
      <script type="text/javascript" charset="utf-8" src="../../../chrome/common/js/search.js"></script>
      <script type="text/javascript" charset="utf-8" src="../../../chrome/common/js/folding.js"></script>
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("#content").find("h1,h2,h3,h4,h5,h6").addAnchor(_("Link to this section"));
        $("#content").find(".wikianchor").each(function() {
          $(this).addAnchor(babel.format(_("Link to #%(id)s"), {id: $(this).attr('id')}));
        });
        $(".foldable").enableFolding(true, true);
      });
    </script>
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="/wiki"><img src="../../../chrome/common/freetz_motd.png" alt="Freetz" /></a>
      </div>
      <form id="search" action="/search" method="get">
        <div>
          <label for="proj-search">Suche:</label>
          <input type="text" id="proj-search" name="q" size="18" value="" />
          <input type="submit" value="Suche" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="/login">Anmelden</a></li><li><a href="/prefs">Einstellungen</a></li><li><a href="../../TracGuide.html">Hilfe/Anleitung</a></li><li><a href="/about">Über Trac</a></li><li><a href="/notification" title="Wiki Pages Change Notifications">My Notifications</a></li><li><a href="/register">Registrieren</a></li><li class="last"><a href="../../Impressum.html">Impressum</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first active"><a href="/wiki">Wiki</a></li><li><a href="/timeline">Journal</a></li><li><a href="/roadmap">Projektplan</a></li><li><a href="/browser">Quellen durchsehen</a></li><li><a href="/report">Tickets anzeigen</a></li><li><a href="/search">Suche</a></li><li><a href="/tags">Tags</a></li><li><a href="/downloads">Downloads</a></li><li class="last"><a href="/screenshots">Bildschirmfotos</a></li>
    </ul>
  </div>
    <div id="langmenu"><ul><li class="first"><span title="Select a language of wiki content">Language:</span></li><li class=" active"><a class="" href="tips..html" title="displaying language (default)">German</a></li><li class=" last"><a class=" notexist" href="/wiki/packages/rudi-shell/tips.en" title="(not available)">English</a></li></ul></div><div id="main">
      <div id="pagepath" class="noprint">
  <a class="pathentry first" title="Zeige WikiStart an" href="/wiki">Wiki:</a><a class="pathentry" href="../../packages.html" title="Zeige packages an">packages</a><span class="pathentry sep">/</span><a class="pathentry" href="../rudi-shell.html" title="Zeige packages/rudi-shell an">rudi-shell</a><span class="pathentry sep">/</span><a class="pathentry" href="tips.html" title="Zeige packages/rudi-shell/tips an">tips</a>
</div>
      <div id="ctxtnav" class="nav">
        <h2>Kontext-Navigation</h2>
        <ul>
          <li class="first"><a href="../rudi-shell.html">Aufwärts</a></li><li><a href="../../WikiStart.html">Startseite</a></li><li><a href="../../TitleIndex.html">Inhaltsverzeichnis</a></li><li><a href="tips%3Faction=history.html">Änderungshistorie</a></li><li class="last"><a href="/notification/packages/rudi-shell/tips" title="Watch Page">Watch Page</a></li>
        </ul>
        <hr />
      </div>
    <div id="content" class="wiki">
      <div class="wikipage searchable">
        
          <div id="wikipage" class="trac-content"><p>
</p><div class="wiki-toc"><h4>Inhaltsverzeichnis</h4><ol><li><a href="../rudi-shell.html#Rudi-Shell">Rudi-Shell</a><ol><li><a href="../rudi-shell.html#Feature-Übersicht">Feature-Übersicht</a></li><li><a href="../rudi-shell.html#Systemvoraussetzungen">Systemvoraussetzungen</a><ol><li><a href="../rudi-shell.html#Server">Server</a></li><li><a href="../rudi-shell.html#Client">Client</a></li><li><a href="../rudi-shell.html#WasNICHTgebrauchtwird">Was NICHT gebraucht wird</a></li><li><a href="../rudi-shell.html#PlatzbedarfderRudi-Shell">Platzbedarf der Rudi-Shell</a></li></ol></li></ol></li><li><a href="install.html#Installation">Installation</a></li><li><a href="functions.html#Funktionsweise">Funktionsweise</a></li><li><a href="usage.html#IllustrierteAnwendungsfälle">Illustrierte Anwendungsfälle</a><ol><li><a href="usage.html#Shell-Skriptausführen">Shell-Skript ausführen</a></li><li><a href="usage.html#Historieverwenden">Historie verwenden</a></li><li><a href="usage.html#DownloadTar-Archiv">Download Tar-Archiv</a></li><li><a href="usage.html#DownloadlangerKonsolenausgabe">Download langer Konsolenausgabe</a></li><li><a href="usage.html#Datei-Upload">Datei-Upload</a></li></ol></li><li><a href="limits.html#GrenzenEinschränkungen">Grenzen &amp; Einschränkungen</a></li><li class="active"><a href="tips.html#TipsTricks">Tips &amp; Tricks</a><ol><li class="active"><a href="tips.html#SichererZugriffviaHTTPS">Sicherer Zugriff via HTTPS</a></li><li class="active"><a href="tips.html#HTTPS-Zugriffreloadedimproved">HTTPS-Zugriff reloaded &amp; improved</a></li><li class="active"><a href="tips.html#Firmwareremoteflashen">Firmware remote flashen</a></li></ol></li></ol></div><p>
</p>
<h1 id="TipsTricks">Tips &amp; Tricks</h1>
<h2 id="SichererZugriffviaHTTPS">Sicherer Zugriff via HTTPS</h2>
<p>
<img src="../../../chrome/wikiextras-icons-16/exclamation.png" style="vertical-align: text-bottom" alt="/!\" /> Achtung: Diese Anleitung wurde geschrieben bevor AVM eine eigene Fernzugrifffunktion integriert hat, weshalb die hier auch nicht erwähnt wird.
</p>
<p>
Jetzt haben wir endlich eine Shell, die über ein reines Web-Interface läuft, sind also unabhängig von <em>Telnet, <a class="wiki" href="../dropbear.html">SSH</a></em> &amp; Co. Was jetzt noch schön wäre: sicherer Zugriff auf die Rudi-Shell oder am besten gleich die ganze Freetz-Konfiguration von außen über eine <a class="ext-link" href="http://de.wikipedia.org/wiki/Transport_Layer_Security"><span class="icon">​</span>SSL</a>-gesicherte Verbindung. Wir könnten dann aus dem Büro oder von jedem Internet-Café der Welt aus unseren Router konfigurieren, ohne auf Proxies oder Portbeschränkungen Rücksicht nehmen zu müssen. Port 443 für <a class="ext-link" href="http://de.wikipedia.org/wiki/Hypertext_Transfer_Protocol_Secure"><span class="icon">​</span>HTTPS</a> ist bei 99% aller Proxies freigeschaltet. Wir bräuchten keinen SSH-Client und hätten trotzdem eine sicher verschlüsselte Verbindung vom Browser zum Router.
</p>
<p>
Genau das konfigurieren wir uns jetzt! Zunächst brauchen wir eine Firmware mit dem Paket <strong><a class="wiki" href="../stunnel.html">stunnel</a></strong>. Das Paket aktiviert übrigens automatisch die beiden Shared Libraries für <a class="ext-link" href="http://de.wikipedia.org/wiki/OpenSSL"><span class="icon">​</span>OpenSSL</a>, nämlich <tt>libcrypto.so</tt> und <tt>libssl.so</tt>. Außerdem wird die <a class="ext-link" href="http://de.wikipedia.org/wiki/Zlib"><span class="icon">​</span>zlib</a> (<tt>libz.so</tt>) benötigt. Weitere Tips und Infos hierzu:
</p>
<ul><li>Der Platzbedarf dieser Pakete ist nicht zu unterschätzen, somit nichts für kleine Boxen: 90 KB für <a class="wiki" href="../stunnel.html">stunnel</a>, 70 KB für die <em>zlib</em> und sage und schreibe 1.150 KB für <em>OpenSSL</em>. Das sind fast 1,3 MB und somit eine Menge. Aber wenn die Box es verkraftet (meine 7170 tut es), werden wir gleich noch viel Spaß haben.
</li><li>Wer eine Firmware mit OpenSSL-Bibliotheken von AVM einsetzt, z.B. die aktuelle 29.04.59 für die 7170, muß aufpassen, daß er in <tt>/var/flash/tr069.cfg</tt> - so vorhanden - die Option <em>enabled = no</em> setzt, bevor die Firmware mit den eigenen Bibliotheken installiert wird (oder aber beim Erstellen des Images gleich den ganzen <a class="wiki" href="../../patches/remove_tr069.html">TR-069 Kram rauspatchen</a> lassen). Ansonsten würde es mit Boxen von 1&amp;1 Probleme beim Aufrufen der durch Freetz ersetzten <em>OpenSSL</em>-Bibliotheken geben. <em>Einige Provider wie z.B. 1&amp;1 verlangen bei Support-Anfragen, dass TR-069 in der Box aktiviert ist! </em>
</li></ul><p>
Als nächstes brauchen wir für den HTTPS-Server ein Serverzertifikat und ein Schlüsselpaar. Das bauen wir uns selbst mit <em>OpenSSL</em>. Das geht unter Linux prinzipiell genauso wie unter Windows, man sollte nur vorsichtshalber darauf achten, daß die Schlüsseldatei, welche am Ende auf der Box landet, UNIX-Zeilenenden hat. Ich erkläre im Folgenden, wie die Generierung eines <a class="ext-link" href="http://en.wikipedia.org/wiki/Self-signed_certificate"><span class="icon">​</span>Self-Signed Key</a> unter Linux abläuft. Es genügt, folgendes Skript auszuführen:
</p>
<div class="code"><pre><span class="c">#!/bin/bash
</span>
<span class="c"># Paßwortgeschützten Server Key erzeugen
</span>openssl genrsa -des3 -out server.key 1024

<span class="c"># Ungeschützte Version extrahieren (der SSL-Server kann ja nicht
# vor der Benutzung selbst ein Paßwort eingeben)
</span>openssl rsa -in server.key -out server.key.unsecure

<span class="c"># Certificate Signing Request (CSR) mit persönlichen Daten erzeugen
</span>openssl req -new -key server.key -out server.csr

<span class="c"># Ein Jahr gültiges, selbst signiertes Zertifikat anfordern
</span>openssl x509 -req -days 365 -in server.csr -signkey server.key -out server.crt

<span class="c"># CSR wird nicht mehr benötigt
</span>rm server.csr

<span class="c"># Schlüssel + Zertifikat (in dieser Reihenfolge!)
</span>


<span class="c"># in einer Datei zusammenführen
</span>cat server.key.unsecure server.crt &gt; stunnel-key.pem

<span class="c"># Nachschauen, ob auch alles da ist
</span>ls -l
</pre></div><p>
Der gesamte Vorgang erfordert zwischendurch die Eingabe einer Passphrase für den Serverschlüssel sowie von persönlichen Daten für das Zertifikat. Das sieht dann inkl. Ein- und Ausgaben beispielsweise so aus:
</p>
<pre class="wiki">$ openssl genrsa -des3 -out server.key 1024
Generating RSA private key, 1024 bit long modulus
..................++++++
.......++++++
e is 65537 (0x10001)
Enter pass phrase for server.key:
Verifying - Enter pass phrase for server.key:

$ openssl rsa -in server.key -out server.key.unsecure
Enter pass phrase for server.key:
writing RSA key

$ openssl req -new -key server.key -out server.csr
Enter pass phrase for server.key:
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter '.', the field will be left blank.
-----
Country Name (2 letter code) [AU]:DE
State or Province Name (full name) [Some-State]:Bavaria
Locality Name (eg, city) []:Munich
Organization Name (eg, company) [Internet Widgits Pty Ltd]:ACME Ltd.
Organizational Unit Name (eg, section) []:
Common Name (eg, YOUR name) []:Manni Muster
Email Address []:manni@acme.de

Please enter the following 'extra' attributes
to be sent with your certificate request
A challenge password []:
An optional company name []:

$ openssl x509 -req -days 365 -in server.csr -signkey server.key -out server.crt
Signature ok
subject=/C=DE/ST=Bavaria/L=Munich/O=ACME Ltd./CN=Manni Muster/emailAddress=manni@acme.de
Getting Private key
Enter pass phrase for server.key:

$ rm server.csr 

$ cat server.key.unsecure server.crt &gt; stunnel-key.pem

$ ls -l
insgesamt 16
-rw-r--r-- 1 ubuntu ubuntu  895 2007-02-26 21:50 server.crt
-rw-r--r-- 1 ubuntu ubuntu  963 2007-02-26 21:41 server.key
-rw-r--r-- 1 ubuntu ubuntu  887 2007-02-26 21:42 server.key.unsecure
-rw-r--r-- 1 ubuntu ubuntu 1782 2007-02-26 22:00 stunnel-key.pem
</pre><p>
Anschließend haben wir in Form der Datei <tt>stunnel-key.pem</tt>, was wir wollten: ein selbst signiertes Schlüsselpaar für unseren HTTPS-Server. Das muß jetzt nur noch irgendwie auf die Box. Dafür gibt es zwei Wege:
</p>
<ul><li>Einbau in die Firmware: Einfach an den gewünschten Ort unter <tt>&lt;Mod-Verzeichnis&gt;/root</tt> kopieren, z.B. nach <tt>/usr/share/stunnel-key.pem</tt>.
</li><li>Einbau in <tt>/var/flash/debug.cfg</tt> oder <tt>/tmp/flash/rc.custom</tt> in der üblichen Form eines Hier-Dokuments, welchen beim Booten der Box entpackt wird, z.B. nach <tt>/tmp/stunnel-key.pem</tt> oder nach <tt>/mod/usr/share/stunnel-key.pem</tt>. Das <a class="ext-link" href="http://en.wikipedia.org/wiki/Here-document"><span class="icon">​</span>Here-Dokument</a> kann so aussehen:
<div class="code"><pre>cat <span class="s">&lt;&lt; EOF_CERT &gt; /tmp/stunnel-key.pem
-----BEGIN RSA PRIVATE KEY-----
# Server-Schlüssel ...
-----END RSA PRIVATE KEY-----
-----BEGIN CERTIFICATE-----
# Zertifikat ...
-----END CERTIFICATE-----
EOF_CERT</span>
</pre></div></li></ul><p>
Wo auch immer die Schlüsseldatei liegt, wir müssen uns in der <em>stunnel</em>-Konfiguration lediglich auf den richtigen Ablageort beziehen. Weiter geht's:
</p>
<p>
Über die Freetz-Oberfläche sorgen wir dafür, daß <em>stunnel</em> als Dienst automatisch gestartet wird und geben unter <em>Einstellungen &rarr; stunnel services</em> folgende Konfiguration ein, um eben diese Web-Oberfläche, in der wir uns gerade aufhalten, zukünftig HTTPS-gesichert verfügbar zu machen:
</p>
<pre class="wiki">[freetz_web]
cert = /tmp/stunnel-key.pem
client = no
accept = 443
connect = 81
</pre><p>
D.h. nichts anderes, als daß wir einen von uns <a class="wiki" href="../../WikiStart.html">Freetz</a> getauften Service verfügbar machen, welcher eingehende SSL-Verbindungen auf dem HTTPS-Port 443 akzeptiert und diese nach dem Entschlüsseln an den Port 81 des Freetz-Webservers weiterleitet. Wichtig: Das Ganze läuft nicht im Client-, sondern im Server-Modus.
</p>
<p>
Das war's schon! Jetzt können wir ausprobieren, was passiert, wenn wir <a class="ext-link" href="https://fritz.box"><span class="icon">​</span>https://fritz.box</a> aufrufen. Es sollten zunächst der Passwort-Dialog von Freetz und anschließend die Web-Oberfläche erscheinen.
</p>
<p>
Wenn wir jetzt noch Services für Port 80 (AVM-Oberfläche) und/oder Port 82 (<a class="missing wiki">WoL?</a>-Oberfläche) haben wollen, fügen wir einfach entsprechende Abschnitte in die Konfiguration ein nach obigem Muster.
</p>
<p>
<img src="../../../chrome/wikiextras-icons-16/exclamation.png" style="vertical-align: text-bottom" alt="/!\" /> <strong>Achtung:</strong> Um den oder die HTTPS-Ports nach außen verfügbar zu machen, müssen entweder die üblichen Einstellungen in <tt>/var/flash/ar7.cfg</tt> vorgenommen werden, also z.B. folgender Abschnitt unter <em>forwardrules</em>
</p>
<pre class="wiki">        "tcp 0.0.0.0:443 0.0.0.0:443",
</pre><p>
oder aber über die AVM-Oberfläche ein entsprechendes <a class="ext-link" href="http://de.wikipedia.org/wiki/Portweiterleitung"><span class="icon">​</span>Port Forwarding</a> auf ein virtuelles Interface konfiguriert werden. Das Ganze benötigen wir pro Service, d.h. wir müssen uns entscheiden, welcher Service den "Premium Port" 443 bekommt, der von überall her erreichbar sein sollte. Ich schlage vor, der Freetz-Oberfläche diesen Port zu geben, denn dadurch gelangen wir an die Rudi-Shell und können somit alles mit der Box anstellen, was wir wollen.
</p>
<p>
<img src="../../../chrome/wikiextras-icons-16/exclamation.png" style="vertical-align: text-bottom" alt="/!\" /> <strong>Wichtig:</strong> Es muß wohl nicht weiter erklärt werden, weshalb bei diesem Szenario einem sicheren Passwort für die Web-Oberfläche besondere Bedeutung zukommt&hellip;
</p>
<h2 id="HTTPS-Zugriffreloadedimproved">HTTPS-Zugriff reloaded &amp; improved</h2>
<p>
Die Aussicht auf ein Paket von (bei mir) 1.310 KB für die oben beschriebene Lösung ist natürlich ein K.O.-Kriterium für kleine Boxen, die sowieso schon mit dem Speicherplatz für einen Firmware-Mod haushalten müssen. Wer sowieso OpenSSL auf der Box für etwas anderes braucht, dem werden die 160 KB für <strong>stunnel + zlib</strong> zusätzlich nicht mehr viel ausmachen. Aber wer SSL nur für den HTTPS-Server benötigt, würde sich sicher über eine schlankere Variante freuen. Das Schöne ist: es gibt eine.
</p>
<p>
Es gibt eine für Embedded-Systeme optimierte Open-Source-SSL-Bibliothek Namens <a class="ext-link" href="http://www.matrixssl.org"><span class="icon">​</span>matrixssl</a>. Außerdem hat jemand für <a class="ext-link" href="http://openwrt.org"><span class="icon">​</span>OpenWRT</a> den kleinen Wrapper <a class="ext-link" href="http://znerol.ch/svn/matrixtunnel/trunk"><span class="icon">​</span>matrixtunnel</a> geschrieben, welcher unsere Alternative zu <a class="wiki" href="../stunnel.html">stunnel</a> sein wird. Und es gibt das Ganze auch bereits als <a class="wiki" href="../matrixtunnel.html">Paket für Freetz</a>. Es handelt sich um ein Paket und eine Bibliothek mit der Gesamtgröße von 110 KB(!). Das entspricht einer Platzersparnis von ca. 92% gegenüber der ersten Lösung und funktioniert genauso gut nach meinen bisherigen Erfahrungen. So schnell wie ohne Verschlüsselung ist das Browsen subjektiv mit beiden HTTPS-Varianten nicht, aber absolut in Ordnung zum Arbeiten.
</p>
<p>
<em>Inzwischen wurde auch <a class="wiki" href="../xrelayd.html">xrelayd</a> der Nachfolger von <a class="wiki" href="../matrixtunnel.html">matrixtunnel</a> in Freetz aufgenommen. Hier wird <a class="wiki" href="../xyssl.html">xyssl</a> (inzwischen polarssl) als Crypt-Lib eingesetzt.</em>
</p>
<p>
Der Aufruf, den man am besten in einer der beim Start ausgeführten Dateien (siehe Beschreibung der <strong>stunnel</strong>-Variante) unterbringt, sieht beispielhaft so aus:
</p>
<div class="code"><pre>matrixtunnel -A cert.pem  -p server_key.pem -d 443 -r 81 -P /tmp/matrixssl.pid
</pre></div><p>
Ich verwende übrigens für <tt>-A</tt> und <tt>-p</tt> denselben Dateinamen und dieselbe kombinierte Datei mit Serverschlüssel und Zertifikat wie für <em>stunnel</em> (Bauanleitung s.o.). Gibt man zusätzlich <tt>-f</tt> an, startet der Server im Vordergrund und man kann die Ausgaben beobachten. Einen Debug-Schalter gibt es auch - einfach mal mit <tt>-?</tt> aufrufen und schauen.
</p>
<p>
Übrigens: <a class="wiki" href="../matrixtunnel.html">matrixtunnel</a> kann auch für jede Schnitstelle (IP-Adresse) eine andere Regel nutzen. Einfach die IP-Addresse vor dem Port (ip:port) angeben wie z.B.
</p>
<div class="code"><pre><span class="c"># ds_mod web über SSL auf LAN
</span>matrixtunnel -A mycert.pem -p mycert.pem -d 192.168.1.1:443 -r 192.168.1.1:81 -P /tmp/matrixssl.pid
<span class="c"># eigene Internetseite über SSL auf Virtual IP für externen Zugang
</span>matrixtunnel -A mycert.pem -p mycert.pem -d 192.168.1.253:443 -r 192.168.1.253:82 -P /tmp/matrixssl.pid 
</pre></div><h2 id="Firmwareremoteflashen">Firmware remote flashen</h2>
<p>
Auch das geht mit Rudi wunderbar, wie ich seit längerer Zeit in einem <a class="ext-link" href="http://www.ip-phone-forum.de/showthread.php?p=846233"><span class="icon">​</span>Beitrag im Forum</a> beschrieben habe. Hier nochmals der Code, den man in der Rudi-Shell auf einmal ausführen kann. Vorher stoppen wir am besten noch einige Freetz-Dienste, welche dem im Code aufgerufenen AVM-Skript nicht bekannt sind und die deshalb weiter laufen und Speicher verbrauchen würden.
</p>
<div class="code"><pre><span class="c"># Bevor wir anfangen, ein Hintergrundbefehl: notfalls in 10 min die Box
# zwangsweise neu starten, das müßte für Download + FW-Update reichen.
</span><span class="o">{</span> sleep 600 ; reboot -f; <span class="o">}</span> &amp;

<span class="o">{</span>
<span class="c"># Unnötige Dienste stoppen, aber websrv und dsld weiter laufen lassen
</span>prepare_fwupgrade start_from_internet
<span class="c"># FW-Image herunterladen und direkt nach "/" entpacken
</span>wget -q -O - http://mein.server.xy/mein.image 2&gt; /dev/null | tar -C / -x
<span class="c"># Restliche Dienste stoppen
</span>prepare_fwupgrade end
<span class="c"># Installation vorbereiten
</span>/var/install
<span class="c"># Installation initialisieren
</span>/var/post_install
<span class="c"># Box neu starten
</span>reboot
<span class="o">}</span>
</pre></div><p>
Dieser Code funktioniert übrigens nicht nur in der Rudi-Shell, sondern grundsätzlich auch innerhalb einer Telnet- oder SSH-Sitzung.
</p>
</div>
          
          <div class="trac-modifiedby">
            <span><a href="tips%3Faction=diff&amp;version=6.html" title="Version 6 von oliver: Update">zuletzt geändert</a> <a class="timeline" href="/timeline?from=2011-03-16T21%3A36%3A28Z&amp;precision=second" title="Siehe Journal am 16.03.2011 21:36:28">vor 8 Jahren</a></span>
            <span class="trac-print">Zuletzt geändert am 16.03.2011 21:36:28</span>
          </div>
        
        
      </div><ul class="tags"><li class="header">Tags</li><li><a href="/tags/https" rel="tag">https</a> </li><li><a href="/tags/remote" rel="tag">remote</a> </li></ul>
      

    </div>
    <script type="text/javascript">
        jQuery.loadStyleSheet("/pygments/trac.css", "text/css");
    </script>
    <div id="altlinks">
      <h3>In anderen Formaten herunterladen:</h3>
      <ul>
        <li class="last first">
          <a rel="nofollow" href="tips%3Fformat=txt">Reiner Text</a>
        </li>
      </ul>
    </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="../../../chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">Betrieben mit <a href="/about"><strong>Trac 1.0.1</strong></a><br />
        von <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right"><div class="field" align="right"><form action="https://www.paypal.com/cgi-bin/webscr" method="post"><input type="hidden" name="cmd" value="_donations"/><input type="hidden" name="business" value="spenden@freetz.org"/><input type="hidden" name="item_name" value="Freetz Entwickler-Team"/><input type="hidden" name="no_shipping" value="1"/><input type="hidden" name="return" value="http://freetz.org"/><input type="hidden" name="cn" value="Name oder IPPF-Pseudonym"/><input type="hidden" name="currency_code" value="EUR"/><input type="hidden" name="tax" value="0"/><input type="hidden" name="lc" value="DE"/><input type="hidden" name="bn" value="PP-DonationsBF"/><input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_LG.gif" border="0" name="submit" alt="Zahlen Sie mit PayPal - schnell, kostenlos und sicher!"/><img alt="" border="0" src="/pixel.gif" width="1" height="1"/></form></div></p>
    </div>
  </body>
</html>