<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

    <html xmlns="http://www.w3.org/1999/xhtml">
  
  


  <head>
    <title>
      packages/strace (diff) – Freetz
    </title>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!--[if IE]><script type="text/javascript">
      if (/^#__msie303:/.test(window.location.hash))
        window.location.replace(window.location.hash.replace(/^#__msie303:/, '#'));
    </script><![endif]-->
        <link rel="search" href="/search" />
        <link rel="help" href="../TracGuide.html" />
        <link rel="up" href="strace%3Faction=history.html" title="Änderungshistorie" />
        <link rel="start" href="/wiki" />
        <link rel="stylesheet" href="../../chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="../../chrome/common/css/wiki.css" type="text/css" /><link rel="stylesheet" href="/chrome/common/css/diff.css" type="text/css" /><link rel="stylesheet" href="../../chrome/wikiextras/css/phrases.css" type="text/css" /><link rel="stylesheet" href="../../chrome/wikiextras/css/boxes.css" type="text/css" /><link rel="stylesheet" href="../../chrome/wikiextras/css/boxes-300.css" type="text/css" /><link rel="stylesheet" href="../../chrome/wikiextras/css/boxes-narrow-toc.css" type="text/css" /><link rel="stylesheet" href="../../wikicss.css" type="text/css" />
        <link rel="prev" href="/wiki/packages/strace?action=diff&amp;version=1" title="Version 1" />
        <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
        <link rel="icon" href="/favicon.ico" type="image/x-icon" />
      <link type="application/opensearchdescription+xml" rel="search" href="/search/opensearch" title="Freetz durchsuchen" />
      <script type="text/javascript" charset="utf-8" src="../../chrome/common/js/jquery.js"></script>
      <script type="text/javascript" charset="utf-8" src="../../chrome/common/js/babel.js"></script>
      <script type="text/javascript" charset="utf-8" src="../../chrome/common/js/messages/de.js"></script>
      <script type="text/javascript" charset="utf-8" src="../../chrome/common/js/trac.js"></script>
      <script type="text/javascript" charset="utf-8" src="../../chrome/common/js/search.js"></script>
      <script type="text/javascript" charset="utf-8" src="/chrome/common/js/diff.js"></script>
    <link rel="stylesheet" type="text/css" href="/chrome/common/css/diff.css" />
    <meta name="ROBOTS" content="NOINDEX, NOFOLLOW" />
  </head>
  <body>
    <div id="banner">
      <div id="header">
        <a id="logo" href="/wiki"><img src="../../chrome/common/freetz_motd.png" alt="Freetz" /></a>
      </div>
      <form id="search" action="/search" method="get">
        <div>
          <label for="proj-search">Suche:</label>
          <input type="text" id="proj-search" name="q" size="18" value="" />
          <input type="submit" value="Suche" />
        </div>
      </form>
      <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="/login">Anmelden</a></li><li><a href="/prefs">Einstellungen</a></li><li><a href="../TracGuide.html">Hilfe/Anleitung</a></li><li><a href="/about">Über Trac</a></li><li><a href="/notification" title="Wiki Pages Change Notifications">My Notifications</a></li><li><a href="/register">Registrieren</a></li><li class="last"><a href="../Impressum.html">Impressum</a></li>
    </ul>
  </div>
    </div>
    <div id="mainnav" class="nav">
    <ul>
      <li class="first active"><a href="/wiki">Wiki</a></li><li><a href="/timeline">Journal</a></li><li><a href="/roadmap">Projektplan</a></li><li><a href="/browser">Quellen durchsehen</a></li><li><a href="/report">Tickets anzeigen</a></li><li><a href="/search">Suche</a></li><li><a href="/tags">Tags</a></li><li><a href="/downloads">Downloads</a></li><li class="last"><a href="/screenshots">Bildschirmfotos</a></li>
    </ul>
  </div>
    <div id="main">
      <div id="ctxtnav" class="nav">
        <h2>Kontext-Navigation</h2>
        <ul>
          <li class="first"><span>&larr; <a class="prev" href="/wiki/packages/strace?action=diff&amp;version=1" title="Version 1">Vorige Änderung</a></span></li><li><a href="strace%3Faction=history.html" title="Änderungshistorie">Änderungshistorie</a></li><li class="last"><span class="missing">Nächste Änderung &rarr;</span></li>
        </ul>
        <hr />
      </div>
    <div id="content" class="wiki">
      <h1>
        Änderungen von <a href="/wiki/packages/strace?version=2">packages/strace</a> zwischen
          <a href="/wiki/packages/strace?version=1">Version 1</a> und
          <a href="/wiki/packages/strace?version=2">Version 2</a>
      </h1>
      <form method="post" id="prefs" action="/wiki/packages/strace?version=2"><div><input type="hidden" name="__FORM_TOKEN" value="d287ce019981e173997e036e" /></div>
        <div>
          <input type="hidden" name="action" value="diff" />
          <input type="hidden" name="version" value="2" />
          <input type="hidden" name="old_version" value="1" />
          
  <label for="style">Zeige Unterschiede</label>
  <select id="style" name="style">
    <option selected="selected" value="inline">untereinander</option>
    <option value="sidebyside">nebeneinander</option>
  </select>
  <div class="field">
    <label><input type="radio" name="contextall" value="0" checked="checked" />
             Zeige</label>
      <label><input type="text" name="contextlines" id="contextlines" size="2" maxlength="3" value="2" />
             Zeilen vor und nach jeder Änderung</label><br />
    <label><input type="radio" name="contextall" value="1" />
           gesamte Datei mit Änderungen zeigen</label>
  </div>
  <fieldset id="ignore">
    <legend>Ignorieren:</legend>
    <div class="field">
      <input type="checkbox" id="ignoreblanklines" name="ignoreblanklines" />
      <label for="ignoreblanklines">Leerzeilen</label>
    </div>
    <div class="field">
      <input type="checkbox" id="ignorecase" name="ignorecase" />
      <label for="ignorecase">Groß-/Kleinschreibung</label>
    </div>
    <div class="field">
      <input type="checkbox" id="ignorewhitespace" name="ignorewhitespace" />
      <label for="ignorewhitespace">Leerzeichen</label>
    </div>
  </fieldset>
  <div style="display:none;"><input type="text" name="sfp_email" value="" /><input type="hidden" name="sfph_mail" value="" /></div><div class="buttons">
    <input type="submit" name="update" value="Aktualisieren" />
  </div>

        </div>
      </form>
      <dl id="overview">
        <dt class="property time">Zeitstempel:</dt>
        <dd class="time">
            08.03.2012 14:07:32 (vor <a class="timeline" href="/timeline?from=2012-03-08T14%3A07%3A32Z&amp;precision=second" title="Siehe Journal am 08.03.2012 14:07:32">7 Jahren</a>)
        </dd>
        <dt class="property author">Autor:</dt>
        <dd class="author">
          kriegaex
        </dd>
        <dt class="property message">Kommentar:</dt>
        <dd class="message">
          
          <p>
How to avoid "unfinished" and "resumed" in multi-process or multi-thread logs
</p>

        </dd>
      </dl>
      <div class="diff">
        <div class="legend" id="diff-legend">
          <h3>Legende:</h3>
          <dl>
            <dt class="unmod"></dt><dd>Unverändert</dd>
            <dt class="add"></dt><dd>Hinzugefügt</dd>
            <dt class="rem"></dt><dd>Entfernt</dd>
            <dt class="mod"></dt><dd>Geändert</dd>
          </dl>
        </div>
        <div class="diff">
  <ul class="entries">
      <li class="entry">
        <h2 id="file0">
          <a href="/wiki/packages/strace?version=2">packages/strace</a>
        </h2>
        <table class="trac-diff inline" summary="Unterschiede" cellspacing="0">
              <colgroup><col class="lineno" /><col class="lineno" /><col class="content" /></colgroup>
              <thead>
                <tr>
                  <th title="Version 1">
                    <a href="/wiki/packages/strace?version=1#L7">
                      v1</a>
                  </th>
                  <th title="Version 2">
                    <a href="/wiki/packages/strace?version=2#L7">
                      v2</a>
                  </th>
                  <td> </td>
                </tr>
              </thead>
            <tbody class="unmod">
                  <tr>
                          <th>7</th><th>7</th><td class="l"><span>Das "Geschwisterchen" [wiki:packages/ltrace ltrace] kann dabei auch hilfreich zur Seite stehen: Anstelle der System-Calls protokolliert ''ltrace'' Bibliotheks-Aufrufe (aka "Library Calls").</span> </td>
                  </tr><tr>
                          <th>8</th><th>8</th><td class="l"><span></span> </td>
                  </tr>
            </tbody><tbody class="add">
                  <tr class="first">
                          <th> </th><th>9</th><td class="r"><ins>== Tip: Vermeiden von "unfinished" und "resumed" in strace-Logs ==</ins> </td>
                  </tr><tr>
                          <th> </th><th>10</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>11</th><td class="r"><ins>Wenn man strace mit "-f" aufruft, um Unterprozesse bzw. Threads mitzuverfolgen, sieht man oft unterbrochene Systemaufrufe im Log, weil strace im Fall einer Unterbrechung den Start- und Rückkehrzeitpunkt der Aufrufe separat notiert. Darunter leidet aber die Lesbarkeit, weil man weiter unten oft nicht mehr weiß, zum welchem "unfinished" welches "resume" gehört (hier im Beispiel ist es noch einfach):</ins> </td>
                  </tr><tr>
                          <th> </th><th>12</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>13</th><td class="r"><ins>{{{</ins> </td>
                  </tr><tr>
                          <th> </th><th>14</th><td class="r"><ins>719&nbsp; &nbsp;14:55:13.562840 clock_gettime(CLOCK_MONOTONIC,&nbsp; &lt;unfinished ...&gt;</ins> </td>
                  </tr><tr>
                          <th> </th><th>15</th><td class="r"><ins>1010&nbsp; 14:55:13.563457 getppid( &lt;unfinished ...&gt;</ins> </td>
                  </tr><tr>
                          <th> </th><th>16</th><td class="r"><ins>719&nbsp; &nbsp;14:55:13.563818 &lt;... clock_gettime resumed&gt; {337216, 716098754}) = 0</ins> </td>
                  </tr><tr>
                          <th> </th><th>17</th><td class="r"><ins>1010&nbsp; 14:55:13.564329 &lt;... getppid resumed&gt; ) = 719</ins> </td>
                  </tr><tr>
                          <th> </th><th>18</th><td class="r"><ins>719&nbsp; &nbsp;14:55:13.564701 clock_gettime(CLOCK_MONOTONIC,&nbsp; &lt;unfinished ...&gt;</ins> </td>
                  </tr><tr>
                          <th> </th><th>19</th><td class="r"><ins>1010&nbsp; 14:55:13.565066 poll([{fd=21, events=POLLIN}], 1, 2000 &lt;unfinished ...&gt;</ins> </td>
                  </tr><tr>
                          <th> </th><th>20</th><td class="r"><ins>719&nbsp; &nbsp;14:55:13.565543 &lt;... clock_gettime resumed&gt; {337216, 717736704}) = 0</ins> </td>
                  </tr><tr>
                          <th> </th><th>21</th><td class="r"><ins>}}}</ins> </td>
                  </tr><tr>
                          <th> </th><th>22</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>23</th><td class="r"><ins>Mittels "-ff" schreibt man eine separate Log-Datei pro PID, aber dann kann mit die Zeitlinie nicht mehr anschaulich verfolgen. Möchte man beides zusammen haben, hilft folgendes Skript (der ''sed''-Befehl ist deshalb so kompliziert, weil bei Aufrufen des Skripts mit mehreren "-p" die in diesem Modus als erste Spalte auftauchenden PIDs in den Einzeldateien zuerst entfernt werden müssen, weil sonst keine Sortierung nach Zeitstempel möglich wäre):</ins> </td>
                  </tr><tr>
                          <th> </th><th>24</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>25</th><td class="r"><ins>{{{</ins> </td>
                  </tr><tr>
                          <th> </th><th>26</th><td class="r"><ins>#!sh</ins> </td>
                  </tr><tr>
                          <th> </th><th>27</th><td class="r"><ins>#!/bin/sh</ins> </td>
                  </tr><tr>
                          <th> </th><th>28</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>29</th><td class="r"><ins># Logfile as first parameter is required</ins> </td>
                  </tr><tr>
                          <th> </th><th>30</th><td class="r"><ins>logfile="$1"</ins> </td>
                  </tr><tr>
                          <th> </th><th>31</th><td class="r"><ins>shift</ins> </td>
                  </tr><tr>
                          <th> </th><th>32</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>33</th><td class="r"><ins># Ctrl-C should only kill strace, not the rest of the script</ins> </td>
                  </tr><tr>
                          <th> </th><th>34</th><td class="r"><ins>trap '' INT</ins> </td>
                  </tr><tr>
                          <th> </th><th>35</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>36</th><td class="r"><ins># Create one logfile per pid, then consolidate them into one,</ins> </td>
                  </tr><tr>
                          <th> </th><th>37</th><td class="r"><ins># sorted by timestamp and containing the pid as 2nd column</ins> </td>
                  </tr><tr>
                          <th> </th><th>38</th><td class="r"><ins>strace -tt -ff -o "$logfile" "$@"</ins> </td>
                  </tr><tr>
                          <th> </th><th>39</th><td class="r"><ins>{</ins> </td>
                  </tr><tr>
                          <th> </th><th>40</th><td class="r"><ins>&nbsp; for file in "$logfile".*; do</ins> </td>
                  </tr><tr>
                          <th> </th><th>41</th><td class="r"><ins>&nbsp; &nbsp; pid=$(printf "%-5u" "${file##$logfile.}")</ins> </td>
                  </tr><tr>
                          <th> </th><th>42</th><td class="r"><ins>&nbsp; &nbsp; cat "$file" | sed -r "s/^([0-9]+ +)?([^ ]+)(.*)/\2 $pid\3/"</ins> </td>
                  </tr><tr>
                          <th> </th><th>43</th><td class="r"><ins>&nbsp; done</ins> </td>
                  </tr><tr>
                          <th> </th><th>44</th><td class="r"><ins>} | sort &gt; "$logfile"</ins> </td>
                  </tr><tr>
                          <th> </th><th>45</th><td class="r"><ins></ins> </td>
                  </tr><tr>
                          <th> </th><th>46</th><td class="r"><ins># Clean up temporary logfiles</ins> </td>
                  </tr><tr>
                          <th> </th><th>47</th><td class="r"><ins>rm "$logfile".*</ins> </td>
                  </tr><tr class="last">
                          <th> </th><th>48</th><td class="r"><ins>}}}</ins> </td>
                  </tr>
            </tbody><tbody class="unmod">
                  <tr>
                          <th>9</th><th>49</th><td class="l"><span>== Weiterführende Links ==</span> </td>
                  </tr><tr>
                          <th>10</th><th>50</th><td class="l"><span>&nbsp;* [http://sourceforge.net/projects/strace/ strace Projektseite] (Sourceforge)</span> </td>
                  </tr>
            </tbody>
        </table>
      </li>
  </ul>
</div>
      </div>
  </div>
    </div>
    <div id="footer" lang="en" xml:lang="en"><hr />
      <a id="tracpowered" href="http://trac.edgewall.org/"><img src="../../chrome/common/trac_logo_mini.png" height="30" width="107" alt="Trac Powered" /></a>
      <p class="left">Betrieben mit <a href="/about"><strong>Trac 1.0.1</strong></a><br />
        von <a href="http://www.edgewall.org/">Edgewall Software</a>.</p>
      <p class="right"><div class="field" align="right"><form action="https://www.paypal.com/cgi-bin/webscr" method="post"><input type="hidden" name="cmd" value="_donations"/><input type="hidden" name="business" value="spenden@freetz.org"/><input type="hidden" name="item_name" value="Freetz Entwickler-Team"/><input type="hidden" name="no_shipping" value="1"/><input type="hidden" name="return" value="http://freetz.org"/><input type="hidden" name="cn" value="Name oder IPPF-Pseudonym"/><input type="hidden" name="currency_code" value="EUR"/><input type="hidden" name="tax" value="0"/><input type="hidden" name="lc" value="DE"/><input type="hidden" name="bn" value="PP-DonationsBF"/><input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_LG.gif" border="0" name="submit" alt="Zahlen Sie mit PayPal - schnell, kostenlos und sicher!"/><img alt="" border="0" src="/pixel.gif" width="1" height="1"/></form></div></p>
    </div>
  </body>
</html>
